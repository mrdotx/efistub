# path:   /home/klassiker/.local/share/repos/efistub/examples/amd/30_arch_linux_lts.conf
# author: klassiker [mrdotx]
# github: https://github.com/mrdotx/efistub
# date:   2023-07-22T19:47:35+0200

# use version number in entry
version_number=false

# efibootmgr options
label="Arch Linux LTS"
disk="/dev/nvme0n1"
loader="/vmlinuz-linux-lts"

options="
    initrd=/amd-ucode.img
    initrd=/initramfs-linux-lts.img
    root=UUID=eac98ebd-4d98-4276-88d1-bbaf9130c2e0 rw

    # lenovo (firmware bugs) mitigations
    tpm_tis.interrupts=0
    tsc=nowatchdog

    # kernel parameter
    quiet
    udev.log_priority=3

    tpm_tis.interrupts=0
    mitigations=off
    #amd_pstate=active
    cpufreq.default_governor=powersave

    # disable watchdog
    nowatchdog
    modprobe.blacklist=sp5100_tco

    # disable beeper
    modprobe.blacklist=pcspkr
"

# version number
[ $version_number = true ] \
    && package_version="$( \
        pacman -Q --color never "linux-lts" \
            | cut -d ' ' -f2 \
            | cut -d '.' -f-3 \
            | cut -d '-' -f1 \
    )" \
    && label="Arch Linux $package_version LTS" \
    && unset package_version
