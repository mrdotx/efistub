# path:   /home/klassiker/.local/share/repos/efistub/entries/m75q/31_arch_linux_lts_fb.conf
# author: klassiker [mrdotx]
# github: https://github.com/mrdotx/efistub
# date:   2022-02-10T20:56:26+0100

# lenovo uefi does not support the same loader (workaround)
cp -u /boot/vmlinuz-linux-lts /boot/vmlinuz-linux-lts-fb

# helper
package_version="$( \
    pacman -Q --color never "linux-lts" \
        | cut -d ' ' -f2 \
        | cut -d '.' -f-3 \
        | cut -d '-' -f1 \
)"

# efibootmgr options
label="Arch Linux $package_version LTS Fallback"
disk="/dev/nvme0n1"
loader="/vmlinuz-linux-lts-fb"

options="
    initrd=/amd-ucode.img
    initrd=/initramfs-linux-lts-fallback.img
    root=UUID=eac98ebd-4d98-4276-88d1-bbaf9130c2e0 rw
"

# unset helper
unset package_version
